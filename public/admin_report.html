<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏• - Admin Dashboard</title>
    <link rel="icon" href="icon.png" type="image/png">
    <link rel="shortcut icon" href="icon.png" type="image/png">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        body { background-color: #f0f2f5; font-family: 'Sarabun', sans-serif; }
        .card-stat { transition: transform 0.2s; border: none; border-radius: 15px; }
        .card-stat:hover { transform: translateY(-5px); }
        .btn-export { border-radius: 50px; font-weight: 600; padding: 8px 20px; transition: all 0.3s; }
        .btn-export:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

    <nav class="navbar navbar-dark bg-dark mb-4 shadow-sm">
        <div class="container">
            <span class="navbar-brand"><i class="fa-solid fa-chart-pie me-2"></i>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</span>
            <a href="dashboard.html" class="btn btn-sm btn-outline-light rounded-pill px-3">
                <i class="fa-solid fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </a>
        </div>
    </nav>

    <div class="container mb-5">
        
        <div class="card shadow-sm border-0 mb-4" style="border-radius: 15px;">
            <div class="card-body p-4">
                <h5 class="fw-bold mb-3"><i class="fa-solid fa-file-excel text-success"></i> ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (Excel)</h5>
                <div class="row g-3">
                    <div class="col-md-3 col-6">
                        <button id="btnExportRepair" class="btn btn-outline-primary w-100 btn-export">
                            <i class="fa-solid fa-tools"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°
                        </button>
                    </div>
                    <div class="col-md-3 col-6">
                        <button id="btnExportCar" class="btn btn-outline-success w-100 btn-export">
                            <i class="fa-solid fa-car"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ä‡πâ‡∏£‡∏ñ
                        </button>
                    </div>
                    <div class="col-md-3 col-6">
                        <button id="btnExportLeave" class="btn btn-outline-warning text-dark w-100 btn-export">
                            <i class="fa-solid fa-person-walking-arrow-right"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏≤
                        </button>
                    </div>
                    <div class="col-md-3 col-6">
                        <button id="btnExportMan" class="btn btn-outline-danger w-100 btn-export">
                            <i class="fa-solid fa-users"></i> ‡∏Ç‡∏≠‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏•
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row g-4 mb-5">
            <div class="col-md-3">
                <div class="card card-stat text-white bg-primary h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <h3><i class="fa-solid fa-screwdriver-wrench"></i></h3>
                        <h6 class="mt-2">‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h6>
                        <h2 id="countRepair" class="fw-bold my-2">...</h2>
                        <small>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card card-stat text-white bg-success h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <h3><i class="fa-solid fa-car-side"></i></h3>
                        <h6 class="mt-2">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏ñ‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</h6>
                        <h2 id="countCar" class="fw-bold my-2">...</h2>
                        <small>‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card card-stat text-white bg-warning text-dark h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <h3><i class="fa-solid fa-person-walking-arrow-right"></i></h3>
                        <h6 class="mt-2">‡∏•‡∏≤/‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</h6>
                        <h2 id="countLeave" class="fw-bold my-2">...</h2>
                        <small>‡∏Ñ‡∏£‡∏±‡πâ‡∏á</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card card-stat text-white bg-danger h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <h3><i class="fa-solid fa-users"></i></h3>
                        <h6 class="mt-2">‡∏Ç‡∏≠‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏•</h6>
                        <h2 id="countMan" class="fw-bold my-2">...</h2>
                        <small>‡∏Ñ‡∏£‡∏±‡πâ‡∏á</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="card shadow-sm h-100 border-0" style="border-radius: 15px;">
                    <div class="card-header bg-white py-3 border-0">
                        <h5 class="m-0 fw-bold text-primary"><i class="fa-solid fa-chart-pie"></i> ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="repairChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="col-md-6 mb-4">
                <div class="card shadow-sm h-100 border-0" style="border-radius: 15px;">
                    <div class="card-header bg-white py-3 border-0">
                        <h5 class="m-0 fw-bold text-success"><i class="fa-solid fa-chart-bar"></i> ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="serviceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, getDocs, doc, getDoc, orderBy, query } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // üî• Config ‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏£‡πå‡∏°
        const firebaseConfig = {
            apiKey: "AIzaSyDYqVJFyuge_4PcObIBMB9h5oIT3fYWuHM",
            authDomain: "school-management-system-10cbb.firebaseapp.com",
            projectId: "school-management-system-10cbb",
            storageBucket: "school-management-system-10cbb.firebasestorage.app",
            messagingSenderId: "674779385916",
            appId: "1:674779385916:web:9a26e4d25282dc23a6f339"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Admin
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                const userDoc = await getDoc(doc(db, "users", user.uid));
                if (userDoc.exists() && userDoc.data().role === 'admin') {
                    loadDashboardData();
                } else {
                    Swal.fire('Error', '‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', 'error').then(() => window.location.href = 'dashboard.html');
                }
            } else {
                window.location.href = "index.html";
            }
        });

        // ----------------------------------------------------
        // üìä ‡∏™‡πà‡∏ß‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
        // ----------------------------------------------------
        async function loadDashboardData() {
            try {
                const repairSnap = await getDocs(collection(db, "repair_requests"));
                const repairs = repairSnap.docs.map(doc => doc.data());
                
                let pending = 0, inProgress = 0, completed = 0, cancelled = 0;
                repairs.forEach(r => {
                    if(r.status === 'pending') pending++;
                    else if(r.status === 'in_progress') inProgress++;
                    else if(r.status === 'completed') completed++;
                    else if(r.status === 'cancelled') cancelled++;
                });

                const carSnap = await getDocs(collection(db, "vehicle_requests"));
                const leaveSnap = await getDocs(collection(db, "leave_requests"));
                const outsideSnap = await getDocs(collection(db, "outside_requests"));
                const manSnap = await getDocs(collection(db, "manpower_requests"));

                document.getElementById('countRepair').innerText = repairs.length;
                document.getElementById('countCar').innerText = carSnap.size;
                document.getElementById('countLeave').innerText = leaveSnap.size + outsideSnap.size;
                document.getElementById('countMan').innerText = manSnap.size;

                // ‡∏Å‡∏£‡∏≤‡∏ü 1: ‡πÇ‡∏î‡∏ô‡∏±‡∏ó
                const ctx1 = document.getElementById('repairChart').getContext('2d');
                new Chart(ctx1, {
                    type: 'doughnut',
                    data: {
                        labels: ['‡∏£‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡πà‡∏≠‡∏°', '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô', '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'],
                        datasets: [{
                            data: [pending, inProgress, completed, cancelled],
                            backgroundColor: ['#ffc107', '#0dcaf0', '#198754', '#6c757d'],
                            borderWidth: 0
                        }]
                    },
                    options: { cutout: '70%', plugins: { legend: { position: 'bottom' } } }
                });

                // ‡∏Å‡∏£‡∏≤‡∏ü 2: ‡πÅ‡∏ó‡πà‡∏á
                const ctx2 = document.getElementById('serviceChart').getContext('2d');
                new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: ['‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°', '‡∏à‡∏≠‡∏á‡∏£‡∏ñ', '‡∏•‡∏≤/‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å', '‡∏Ç‡∏≠‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏•'],
                        datasets: [{
                            label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏Ñ‡∏£‡∏±‡πâ‡∏á)',
                            data: [repairSnap.size, carSnap.size, leaveSnap.size + outsideSnap.size, manSnap.size],
                            backgroundColor: ['rgba(13, 110, 253, 0.7)', 'rgba(25, 135, 84, 0.7)', 'rgba(255, 193, 7, 0.7)', 'rgba(220, 53, 69, 0.7)'],
                            borderColor: ['#0d6efd', '#198754', '#ffc107', '#dc3545'],
                            borderWidth: 1, borderRadius: 5
                        }]
                    },
                    options: { scales: { y: { beginAtZero: true, grid: { display: false } }, x: { grid: { display: false } } }, plugins: { legend: { display: false } } }
                });

            } catch (error) { console.error("Error loading dashboard:", error); }
        }

        // ----------------------------------------------------
        // üì• ‡∏™‡πà‡∏ß‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Export Excel
        // ----------------------------------------------------

        // 1. Export ‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°
        document.getElementById('btnExportRepair').addEventListener('click', async () => {
            await exportToExcel("repair_requests", "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°", (d) => ({
                "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á": formatDate(d.created_at),
                "‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á": d.reporterName || d.requester_name || '-',
                "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå/‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á": d.equipment || d.topic || '-',
                "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà": d.location || '-',
                "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î": d.detail || d.description || '-',
                "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞": getStatusThai(d.status),
                "‡∏ä‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö": d.technician_name || '-',
                "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°": d.repair_note || '-'
            }));
        });

        // 2. Export ‡∏à‡∏≠‡∏á‡∏£‡∏ñ
        document.getElementById('btnExportCar').addEventListener('click', async () => {
            await exportToExcel("vehicle_requests", "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏£‡∏ñ‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£", (d) => ({
                "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á": d.use_date,
                "‡πÄ‡∏ß‡∏•‡∏≤": `${d.start_time} - ${d.end_time}`,
                "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏õ": d.destination,
                "‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡πÉ‡∏ä‡πâ": d.reporterName || d.requester_name,
                "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô": d.passenger_count,
                "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏": d.reason || '-',
                "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞": getStatusThai(d.status),
                "‡∏£‡∏ñ/‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö": d.car_plate || '-'
            }));
        });

        // 3. Export ‡∏Å‡∏≤‡∏£‡∏•‡∏≤
        document.getElementById('btnExportLeave').addEventListener('click', async () => {
            await exportToExcel("leave_requests", "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏≤", (d) => ({
                "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£": formatDate(d.created_at),
                "‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•": d.requester_name,
                "‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤": d.leave_type,
                "‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà": d.start_date,
                "‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà": d.end_date,
                "‡∏£‡∏ß‡∏°(‡∏ß‡∏±‡∏ô)": d.total_days,
                "‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•": d.reason,
                "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠": d.contact_phone || '-',
                "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞": getStatusThai(d.status)
            }));
        });

        // 4. Export ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏•
        document.getElementById('btnExportMan').addEventListener('click', async () => {
            await exportToExcel("manpower_requests", "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏•", (d) => ({
                "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ": d.use_date,
                "‡πÄ‡∏ß‡∏•‡∏≤": d.use_time,
                "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°": d.activity,
                "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà": d.location,
                "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô(‡∏Ñ‡∏ô)": d.people_count,
                "‡∏ú‡∏π‡πâ‡∏Ç‡∏≠": d.requester_name,
                "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞": getStatusThai(d.status)
            }));
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Export
        async function exportToExcel(collectionName, fileName, mapFunction) {
            Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel...', didOpen: () => Swal.showLoading() });
            try {
                const q = query(collection(db, collectionName), orderBy("created_at", "desc"));
                const querySnapshot = await getDocs(q);
                
                if (querySnapshot.empty) {
                    Swal.fire('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ', 'info');
                    return;
                }

                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° mapFunction ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤
                const data = querySnapshot.docs.map(doc => mapFunction(doc.data()));

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á Excel
                const ws = XLSX.utils.json_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                
                // ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
                XLSX.writeFile(wb, `${fileName}_${new Date().toISOString().slice(0,10)}.xlsx`);
                
                Swal.close();
            } catch (error) {
                console.error(error);
                Swal.fire('Error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            }
        }

        // Helper ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà Timestamp -> ‡πÑ‡∏ó‡∏¢
        function formatDate(timestamp) {
            if (!timestamp) return "-";
            const date = new Date(timestamp.seconds * 1000);
            return date.toLocaleDateString('th-TH', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        // Helper ‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ó‡∏¢
        function getStatusThai(status) {
            const map = {
                'pending': '‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥/‡∏£‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á',
                'in_progress': '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                'approved': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß',
                'rejected': '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥',
                'completed': '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô',
                'cancelled': '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
            };
            return map[status] || status;
        }

    </script>
</body>
</html>